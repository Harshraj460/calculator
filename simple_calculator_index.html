<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Calculator</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#9aa7bf;--btn:#111827}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg,#071029 0%, #0b1630 100%);
      color:#e6eef8; padding:24px;
    }
    .calculator{
      width:360px; max-width:100%; background:linear-gradient(180deg,var(--card), #071022);
      border-radius:14px; padding:18px; box-shadow:0 10px 30px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }
    .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .title{font-weight:600;font-size:18px}
    .subtitle{font-size:12px;color:var(--muted)}
    .display{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:10px; padding:14px; min-height:64px; display:flex; flex-direction:column; justify-content:center; margin-bottom:14px; 
      border:1px solid rgba(255,255,255,0.02);
    }
    .expr{font-size:14px; color:var(--muted); word-break:break-all}
    .value{font-size:28px; font-weight:600; text-align:right;}
    .pad{display:grid; grid-template-columns:repeat(4,1fr); gap:10px}
    button.key{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:10px; padding:18px; font-size:18px; border:1px solid rgba(255,255,255,0.02);
      cursor:pointer; box-shadow:inset 0 -2px 0 rgba(0,0,0,0.3); color:inherit;
    }
    button.key:active{transform:translateY(1px)}
    .key.operator{background:linear-gradient(180deg,#0b2b48,#06203a); color:var(--accent); font-weight:600}
    .key.ctrl{background:linear-gradient(180deg,#1a1f2b,#0f1724)}
    .key.equal{grid-column:span 2; background:linear-gradient(180deg,#2563eb,#1e40af); color:white; font-weight:700}
    .small{font-size:14px}
    .footer{margin-top:12px;text-align:center;color:var(--muted);font-size:12px}
    @media (max-width:420px){.calculator{padding:12px}.value{font-size:22px}}
  </style>
</head>
<body>
  <main class="calculator" role="application" aria-label="Simple calculator">
    <div class="header">
      <div>
        <div class="title">Simple Calculator</div>
        <div class="subtitle">Supports + − × ÷, decimals and parentheses</div>
      </div>
      <div class="small">Press Enter for =</div>
    </div>

    <div class="display" id="display">
      <div class="expr" id="expr">&nbsp;</div>
      <div class="value" id="value">0</div>
    </div>

    <div class="pad" role="grid">
      <button class="key ctrl" data-action="clear">C</button>
      <button class="key ctrl" data-action="back">⌫</button>
      <button class="key ctrl" data-action="percent">%</button>
      <button class="key operator" data-key="/">÷</button>

      <button class="key" data-key="7">7</button>
      <button class="key" data-key="8">8</button>
      <button class="key" data-key="9">9</button>
      <button class="key operator" data-key="*">×</button>

      <button class="key" data-key="4">4</button>
      <button class="key" data-key="5">5</button>
      <button class="key" data-key="6">6</button>
      <button class="key operator" data-key="-">−</button>

      <button class="key" data-key="1">1</button>
      <button class="key" data-key="2">2</button>
      <button class="key" data-key="3">3</button>
      <button class="key operator" data-key="+">+</button>

      <button class="key" data-key="0" style="grid-column:span 2;">0</button>
      <button class="key" data-key=".">.</button>
      <button class="key equal" data-action="equals">=</button>
    </div>

    <div class="footer">Tip: you can type using your keyboard — numbers, + - * / , parentheses and Enter for equals.</div>
  </main>

  <script>
    (function(){
      const exprEl = document.getElementById('expr');
      const valueEl = document.getElementById('value');
      let expr = '';

      function render(){
        exprEl.textContent = expr || '\u00A0';
        valueEl.textContent = expr ? tryEvalPreview(expr) : '0';
      }

      function tryEvalPreview(s){
        try{
          // allow only digits, operators, parentheses, spaces, and dot
          if(!/^[0-9+\-*/().%\s]*$/.test(s)) return 'Err';
          // replace any ÷ or × if present
          const safe = s.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-').replace(/%/g,'/100');
          const res = Function('return ('+safe+')')();
          if(res === Infinity || res === -Infinity || Number.isNaN(res)) return 'Err';
          // shorten long results
          return (Math.round((res + Number.EPSILON) * 1e12)/1e12).toString();
        }catch(e){
          return '';
        }
      }

      function appendKey(k){
        // prevent two operators in a row (except '(' and ')')
        if(/[+\-*/.]/.test(k) && expr.slice(-1) === k) return;
        expr += k;
        render();
      }

      function clearAll(){ expr = ''; render(); }
      function backspace(){ expr = expr.slice(0,-1); render(); }

      function percent(){
        // simple percent: append % (handled in preview) or convert last number to percent
        if(expr === '') return;
        // if last char is digit or ')', append %
        if(/[0-9)]$/.test(expr)) { expr += '%'; render(); }
      }

      function equals(){
        try{
          if(!expr) return;
          if(!/^[0-9+\-*/().%\s]*$/.test(expr)) { valueEl.textContent = 'Error'; return; }
          const safe = expr.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-').replace(/%/g,'/100');
          const res = Function('return ('+safe+')')();
          if(!isFinite(res) || Number.isNaN(res)) { valueEl.textContent = 'Error'; return; }
          expr = (Math.round((res + Number.EPSILON) * 1e12)/1e12).toString();
          render();
        }catch(e){ valueEl.textContent = 'Error'; }
      }

      document.querySelectorAll('button.key').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.dataset.key;
          const action = btn.dataset.action;
          if(action){
            if(action==='clear') clearAll();
            if(action==='back') backspace();
            if(action==='percent') percent();
            if(action==='equals') equals();
          } else if(key){
            appendKey(key);
          }
        });
      });

      // keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){ e.preventDefault(); equals(); return; }
        if(e.key === 'Backspace'){ e.preventDefault(); backspace(); return; }
        if(e.key === 'Escape'){ e.preventDefault(); clearAll(); return; }
        if(e.key === '%'){ e.preventDefault(); percent(); return; }
        // allow digits, operators and parentheses
        if(/^[0-9+\-*/().]$/.test(e.key)){
          e.preventDefault(); appendKey(e.key);
        }
      });

      render();
    })();
  </script>
</body>
</html>
